<div align="center">

<a href="https://www.python.org"><img alt="Python" src="https://img.shields.io/badge/-Python_3.10-blue?logo=python&logoColor=white"></a>
<a href="https://pytorch.org/get-started/locally/"><img alt="PyTorch" src="https://img.shields.io/badge/PyTorch_2.2-ee4c2c?logo=pytorch&logoColor=white"></a>

# Automatic Benchmarking of Vision-Language Models via Iterative Experiment Programming

</div>

## Setup

### Install dependencies

```bash
# clone project
git clone https://github.com/altndrr/apex
cd apex

# install requirements
# it will create a .venv folder in the project root
# and install all the dependencies using flit
make install

# activate virtual environment
source .venv/bin/activate
```

### Setup environment variables

```bash
# copy .env.example to .env
cp .env.example .env

# edit .env file
vim .env
```

## Usage

The two entry points are `train.py` and `eval.py`. Calling them without any argument will use the default configuration.

```bash
# train model
python src/train.py

# test model
python src/eval.py
```

### Configuration

The full list of parameters can be found under [configs](configs/), but the most important ones are:

- [data](configs/data/): dataset to use, default to `caltech101`.
- [experiment](configs/experiment/): experiment to run, default to `baseline/clip`.
- [logger](configs/logger/): logger to use, default to `null`.

Parameters can be overwritten by passing them as command line arguments. You can additionally override any parameter from the config file by using the `++` prefix.

```bash
# train model on ucf101 dataset
python src/train.py data=ucf101 experiment=baseline/clip

# train model on ucf101 dataset with RN50 backbone
python src/train.py data=ucf101 experiment=baseline/clip model=clip ++model.model_name=RN50
```

Note that since all our approaches are training-free, there is virtually no difference between `train.py` and `eval.py`. However, we still keep them separate for clarity.

## Development

### Install pre-commit hooks

```bash
# install pre-commit hooks
pre-commit install
```

### Run tests

```bash
# run fast tests
make test

# run all tests
make test-full
```

### Format code

```bash
# run linters
make format
```

### Clean repository

```bash
# remove autogenerated files
make clean

# remove logs
make clean-logs
```
